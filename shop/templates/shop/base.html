<!doctype html>
<html lang="uk">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark">
    <link 
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"
    >
    <link 
      rel="stylesheet" 
      href="https://cdnjs.cloudflare.com/ajax/libs/flexboxgrid/6.3.1/flexboxgrid.min.css"
    >
    <link 
      rel="stylesheet" 
      href="https://cdn.jsdelivr.net/gh/iconoir-icons/iconoir@main/css/iconoir.css" 
    >
    <title>{% block title %}Літера{% endblock %}</title>
  </head>
  <body>
    <header class="container-fluid">
      <nav>
        <ul>
          <li><h1><a href="/">Літера</a></h1></li>
        </ul>
        <ul>
          <li><a href="{% url 'shop:product_list' %}">Каталог</a></li>
          {% if request.user.is_authenticated %}
            <li>
              <details class="dropdown">
                <summary>
                  {{ request.user.first_name|default:request.user.username }}
                </summary>
                <ul dir="rtl">
                  <li><a href="{% url 'edit' %}">Профіль</a></li>
                  {% comment %} <li><a href="#">Logout</a></li> {% endcomment %}
                  <form action="{% url 'logout' %}" method="post">
                    {% csrf_token %}
                    <input type="submit" value="Вихід">
                    <li><a href="{% url 'register' %}">Реєстрація</a></li>
                  </form>
                </ul>
              </details>
            </li>
          {% else %}
            <li><a href="{% url 'login' %}">Вхід</a></li>
          {% endif %}
          <li><a href="{% url 'cart:cart_detail' %}">
            {% with total_items=cart|length %}
              {% if total_items > 0 %}
                <i class="iconoir-cart"></i>
                <span><sup>{{ total_items }}</sup></span>
              {% endif %}
            {% endwith %}
          </a></li>
        </ul>
      </nav>
    </header> 

    <div class="container" id="messages">
      {% for message in messages %}
        <dialog open id="message">
          <article>
            <header>
              <button aria-label="Close" rel="prev" id="close-button"></button>
              <p>
                {% if message.tags == 'error' %}
                  ❌ Помилка
                {% else %}
                  ✅ Успішно
                {% endif %}
              </p>
            </header>
            <p>
              {{ message|safe }}
            </p>
          </article>
        </dialog>
      {% endfor %}
    </div>

    <main class="container">
      <section class="row">
        <div class="col-lg-12">
          {% block content %}
            <article class="box">Каталог товарів</article>
          {% endblock  %}
        </div>
      </section>
    </main>

    <footer class="container-fluid">
      <p align="center">&copy; 2025 Літера</p>
    </footer>

    <script>
      // Cancel button closes the dialog box
      const dialog = document.getElementById("message");
      const cancelButton = document.getElementById("close-button");
      cancelButton.addEventListener("click", () => {
        dialog.close(); // Set dialog.returnValue to null
      });
    </script>
  </body>
</html>
